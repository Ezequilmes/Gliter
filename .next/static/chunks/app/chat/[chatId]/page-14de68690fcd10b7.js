(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[576],{3516:function(e,a,t){Promise.resolve().then(t.bind(t,8047))},8049:function(e,a,t){"use strict";var s=t(4397);function r(){}function i(){}i.resetWarningCache=r,e.exports=function(){function e(e,a,t,r,i,o){if(o!==s){var l=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw l.name="Invariant Violation",l}}function a(){return e}e.isRequired=e;var t={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:a,element:e,elementType:e,instanceOf:a,node:e,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:i,resetWarningCache:r};return t.PropTypes=t,t}},718:function(e,a,t){e.exports=t(8049)()},4397:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},8047:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return v}});var s=t(7437),r=t(2265),i=t(6410),o=t(9376),l=t(2660),n=t(9763);let c=(0,n.Z)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),d=(0,n.Z)("Smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),m=(0,n.Z)("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),u=(0,n.Z)("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);var h=t(3145),x=t(4747),f=t(7240),p=t(718),g=t.n(p);let b=e=>{let{message:a,isOwn:t,senderName:r}=e;return new Date(a.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),(0,s.jsx)("div",{className:"flex ".concat(t?"justify-end":"justify-start"," mb-4"),children:(0,s.jsxs)("div",{className:"max-w-xs lg:max-w-md ".concat(t?"order-2":"order-1"),children:[!t&&(0,s.jsx)("p",{className:"text-xs text-gray-500 mb-1 px-3",children:r}),(0,s.jsxs)("div",{className:"relative px-4 py-2 rounded-2xl ".concat(t?"bg-primary-500 text-white rounded-br-md":"bg-gray-100 text-gray-900 rounded-bl-md"),children:["texto"===a.tipo?(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words",children:a.message}):(0,s.jsxs)("div",{className:"space-y-2",children:[a.urlFoto&&(0,s.jsx)("div",{className:"relative w-48 h-32 rounded-lg overflow-hidden",children:(0,s.jsx)(h.default,{src:a.urlFoto,alt:"Imagen enviada",fill:!0,className:"object-cover",onError:e=>{e.target.src="data:image/svg+xml;base64,".concat(btoa('<svg xmlns="http://www.w3.org/2000/svg" width="192" height="128" viewBox="0 0 192 128">\n                          <rect width="192" height="128" fill="#f3f4f6"/>\n                          <text x="96" y="70" text-anchor="middle" fill="#6b7280" font-size="14">\n                            Imagen no disponible\n                          </text>\n                        </svg>'))}})}),a.message&&"Foto enviada"!==a.message&&(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words",children:a.message})]}),(0,s.jsx)("p",{className:"text-xs mt-1 ".concat(t?"text-primary-100":"text-gray-500"),children:(e=>{try{return(0,x.Q)(e,{addSuffix:!0,locale:f.es})}catch(e){return"hace un momento"}})(a.timestamp)}),t&&(0,s.jsx)("div",{className:"flex items-center justify-end mt-1 space-x-1",children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("svg",{className:"w-3 h-3 text-primary-100",fill:"currentColor",viewBox:"0 0 20 20",role:"img","aria-hidden":"true",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),(0,s.jsx)("svg",{className:"w-3 h-3 text-primary-100 -ml-1",fill:"currentColor",viewBox:"0 0 20 20",role:"img","aria-hidden":"true",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})]})})]})]})})};b.propTypes={message:g().object.isRequired,isOwn:g().bool.isRequired,senderName:g().string.isRequired};var y=e=>{let{currentUser:a,otherUser:t,chatId:i,onSendMessage:o,onClose:l}=e,[n,x]=(0,r.useState)([]),[f,p]=(0,r.useState)(""),[g,y]=(0,r.useState)(!1),[v,j]=(0,r.useState)(!1),w=(0,r.useRef)(null),N=(0,r.useRef)(null);(0,r.useEffect)(()=>{x([{id:"1",senderId:t.uid,message:"\xa1Hola! Me gusta tu perfil \uD83D\uDE0A",tipo:"texto",timestamp:new Date(Date.now()-36e5)},{id:"2",senderId:a.uid,message:"\xa1Hola! Gracias, el tuyo tambi\xe9n est\xe1 genial",tipo:"texto",timestamp:new Date(Date.now()-35e5)},{id:"3",senderId:t.uid,message:"\xbfTe gustar\xeda conocernos mejor?",tipo:"texto",timestamp:new Date(Date.now()-34e5)}])},[a.uid,t.uid]);let D=()=>{var e;null===(e=w.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})};(0,r.useEffect)(()=>{D()},[n]);let k=()=>{if(f.trim()){let e={id:Date.now().toString(),senderId:a.uid,message:f,tipo:"texto",timestamp:new Date};x(a=>[...a,e]),o(f,"texto"),p("")}};return(0,s.jsxs)("div",{className:"flex flex-col h-full bg-white",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full overflow-hidden",children:(0,s.jsx)(h.default,{src:t.fotoPerfil,alt:t.nombre,width:40,height:40,className:"object-cover",onError:e=>{e.target.src="data:image/svg+xml;base64,".concat(btoa('<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40" viewBox="0 0 40 40">\n                      <rect width="40" height="40" fill="#a855f7"/>\n                      <text x="20" y="25" text-anchor="middle" fill="white" font-size="16" font-weight="bold">\n                        '.concat(t.nombre.charAt(0).toUpperCase(),"\n                      </text>\n                    </svg>")))}})}),(0,s.jsx)("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-green-400 border-2 border-white rounded-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-gray-900",children:t.nombre}),(0,s.jsx)("p",{className:"text-sm text-green-500",children:"En l\xednea"})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:(0,s.jsx)(c,{className:"w-5 h-5 text-gray-600"})}),l&&(0,s.jsx)("button",{onClick:l,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:"✕"})]})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[n.map(e=>(0,s.jsx)(b,{message:e,isOwn:e.senderId===a.uid,senderName:e.senderId===a.uid?a.nombre:t.nombre},e.id)),g&&(0,s.jsxs)("div",{className:"flex items-center space-x-2 text-gray-500",children:[(0,s.jsxs)("div",{className:"flex space-x-1",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce"}),(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]}),(0,s.jsxs)("span",{className:"text-sm",children:[t.nombre," est\xe1 escribiendo..."]})]}),(0,s.jsx)("div",{ref:w})]}),v&&(0,s.jsx)("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:["\uD83D\uDE0A","\uD83D\uDE02","❤️","\uD83D\uDC4D","\uD83D\uDD25","\uD83D\uDE0D","\uD83E\uDD70","\uD83D\uDE18"].map(e=>(0,s.jsx)("button",{onClick:()=>{p(a=>a+e),j(!1)},className:"p-2 hover:bg-gray-200 rounded-lg transition-colors text-xl",children:e},e))})}),(0,s.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-white",children:[(0,s.jsxs)("div",{className:"flex items-end space-x-2",children:[(0,s.jsx)("div",{className:"flex-1 relative",children:(0,s.jsx)("textarea",{value:f,onChange:e=>p(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k())},placeholder:"Escribe un mensaje a ".concat(t.nombre,"..."),className:"w-full px-4 py-2 border border-gray-300 rounded-full resize-none focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent max-h-32",rows:1,style:{minHeight:"40px",height:"auto"},onInput:e=>{let a=e.target;a.style.height="auto",a.style.height=a.scrollHeight+"px"}})}),(0,s.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,s.jsx)("button",{onClick:()=>j(!v),className:"p-2 text-gray-600 hover:text-primary-600 hover:bg-primary-50 rounded-full transition-colors",title:"Emojis",children:(0,s.jsx)(d,{className:"w-5 h-5"})}),(0,s.jsx)("button",{onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},className:"p-2 text-gray-600 hover:text-primary-600 hover:bg-primary-50 rounded-full transition-colors",title:"Enviar foto",children:(0,s.jsx)(m,{className:"w-5 h-5"})}),(0,s.jsx)("button",{onClick:k,disabled:!f.trim(),className:"p-2 bg-primary-500 text-white rounded-full hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"Enviar mensaje",children:(0,s.jsx)(u,{className:"w-5 h-5"})})]})]}),(0,s.jsx)("input",{ref:N,type:"file",accept:"image/*",onChange:e=>{var t;let s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s&&s.type.startsWith("image/")){let e={id:Date.now().toString(),senderId:a.uid,message:"Foto enviada",tipo:"foto",urlFoto:URL.createObjectURL(s),timestamp:new Date};x(a=>[...a,e]),o("Foto enviada","foto",s)}},className:"hidden"})]})]})},v=()=>{let[e,a]=(0,r.useState)(null),[t,n]=(0,r.useState)(!0),c=(0,o.useRouter)(),d=(0,o.useParams)().chatId,[m,u]=(0,r.useState)(null),[h,x]=(0,r.useState)(null);(0,r.useEffect)(()=>i.I8.onAuthStateChanged(e=>{a(e),n(!1),e||c.push("/auth")}),[c]),(0,r.useEffect)(()=>{if(e&&d){let a={uid:e.uid,nombre:"Tu Usuario",edad:25,genero:"Hombre",ubicacion:{lat:-34.6037,lng:-58.3816},rolSexual:"vers\xe1til",fotoPerfil:"https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=150&h=150&fit=crop&crop=face",fotosAdicionales:[],favoritos:[],bloqueados:[],lastOnline:new Date,email:e.email||"tu@example.com"},t={chat1:{uid:"user1",nombre:"Ana Garc\xeda",edad:25,genero:"Mujer",ubicacion:{lat:-34.6037,lng:-58.3816},rolSexual:"vers\xe1til",fotoPerfil:"https://images.unsplash.com/photo-1494790108755-2616b612b786?w=150&h=150&fit=crop&crop=face",fotosAdicionales:[],favoritos:[],bloqueados:[],lastOnline:new Date,email:"ana@example.com"},chat2:{uid:"user2",nombre:"Carlos Mendez",edad:28,genero:"Hombre",ubicacion:{lat:-34.6037,lng:-58.3816},rolSexual:"activo",fotoPerfil:"https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=150&h=150&fit=crop&crop=face",fotosAdicionales:[],favoritos:[],bloqueados:[],lastOnline:new Date(Date.now()-3e5),email:"carlos@example.com"},chat3:{uid:"user3",nombre:"Sofia Rodriguez",edad:23,genero:"Mujer",ubicacion:{lat:-34.6037,lng:-58.3816},rolSexual:"pasivo",fotoPerfil:"https://images.unsplash.com/photo-1438761681033-6461ffad8d80?w=150&h=150&fit=crop&crop=face",fotosAdicionales:[],favoritos:[],bloqueados:[],lastOnline:new Date(Date.now()-36e5),email:"sofia@example.com"},default:{uid:"unknown-user",nombre:"Usuario Desconocido",edad:25,genero:"No especificado",ubicacion:{lat:-34.6037,lng:-58.3816},rolSexual:null,fotoPerfil:"https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?w=150&h=150&fit=crop&crop=face",fotosAdicionales:[],favoritos:[],bloqueados:[],lastOnline:new Date,email:"unknown@example.com"}};x(a),u(t[d]||t.default)}},[e,d]);let f=()=>{c.push("/chat")};return t?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-accent-500"})}):e&&h&&m?(0,s.jsxs)("div",{className:"h-screen flex flex-col bg-gray-50",children:[(0,s.jsx)("div",{className:"lg:hidden bg-white shadow-sm border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex items-center p-4",children:[(0,s.jsx)("button",{onClick:f,className:"p-2 hover:bg-gray-100 rounded-full transition-colors mr-2",children:(0,s.jsx)(l.Z,{className:"w-5 h-5 text-gray-600"})}),(0,s.jsx)("h1",{className:"text-lg font-semibold text-gray-900",children:m.nombre})]})}),(0,s.jsxs)("div",{className:"flex-1 flex",children:[(0,s.jsxs)("div",{className:"hidden lg:block w-80 bg-white border-r border-gray-200",children:[(0,s.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,s.jsxs)("button",{onClick:()=>c.push("/"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[(0,s.jsx)(l.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{children:"Volver al inicio"})]})}),(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Mensajes"}),(0,s.jsx)("div",{className:"space-y-2",children:["chat1","chat2","chat3"].map(e=>{let a=e===d;return(0,s.jsxs)("button",{onClick:()=>c.push("/chat/".concat(e)),className:"w-full text-left p-3 rounded-lg transition-colors ".concat(a?"bg-primary-50 border border-primary-200":"hover:bg-gray-50"),children:[(0,s.jsx)("div",{className:"font-medium text-gray-900",children:{chat1:"Ana Garc\xeda",chat2:"Carlos Mendez",chat3:"Sofia Rodriguez"}[e]}),(0,s.jsx)("div",{className:"text-sm text-gray-500 truncate",children:"\xdaltimo mensaje..."})]},e)})})]})]}),(0,s.jsx)("div",{className:"flex-1 flex flex-col",children:(0,s.jsx)(y,{currentUser:h,otherUser:m,chatId:d,onSendMessage:(e,a,t)=>{console.log("Enviando mensaje:",{message:e,type:a,file:t})},onClose:f})})]})]}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Chat no encontrado"}),(0,s.jsx)("p",{className:"text-gray-600 mb-4",children:"No se pudo cargar la conversaci\xf3n"}),(0,s.jsx)("button",{onClick:()=>c.push("/chat"),className:"btn-primary",children:"Volver a mensajes"})]})})}},6410:function(e,a,t){"use strict";t.d(a,{I8:function(){return n},db:function(){return c},tO:function(){return d}});var s=t(738),r=t(3301),i=t(5978),o=t(62);let l=(0,s.C6)().length?(0,s.Mq)():(0,s.ZF)({apiKey:"AIzaSyBs4YagBaR9gXnFLE_tfHhWARpOZdo7m38",authDomain:"soygay-b9bc5.firebaseapp.com",projectId:"soygay-b9bc5",storageBucket:"soygay-b9bc5.appspot.com",messagingSenderId:"982386751624",appId:"1:982386751624:web:20a3ee764ec4c6f0da073d"}),n=(0,r.v0)(l),c=(0,i.ad)(l),d=(0,o.cF)(l)}},function(e){e.O(0,[358,139,847,492,361,971,117,744],function(){return e(e.s=3516)}),_N_E=e.O()}]);